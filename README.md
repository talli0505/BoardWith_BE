# 🎮 보드 윗(Board With) 🎮

<img width="80%" src="https://i.ibb.co/R0Tw1Fs/Kakao-Talk-20221208-232135692.png" >

<h2>이 프로젝트는 2022-11-04 ~ 2022-12-16일까지 진행되었습니다.</h2>

<br>

# 🎁[보드 윗 노션 바로가기](https://brief-efraasia-82e.notion.site/board-with-c923e853540941589be0f4f4984022f4)
# 🎁[보드 윗 링크 바로가기](https://boardwith.vercel.app/)

<br>

# 🕹 팀원 소개

|**팀원**|**주특기**|**맡은 파트**|
|:-----:|:-----:|:-----:|
|김지용|FE(VL)|회원가입, 기본 및 소셜(카톡)로그인, 마이페이지, 아바타, 채팅방|
|김수진|FE|메인, 필터, 게시글작성, 소셜(네이버)로그인, 검색페이지|
|정원지|FE|상세페이지, 댓글, 블랙리스트, 소셜(구글)로그인, 랭킹페이지|
|조민수|BE(L)|회원가입, 기본 및 소셜(카톡,구글)로그인, 마이페이지, 채팅방, 스웨거|
|서수형|BE|게시글, 랭킹, 북마크, 페이지 무한스크롤, 참가자 목록 추가 및 제거 , 강퇴시스템, 스웨거|
|백이현|BE|댓글, 게시글 검색 및 필터링, 소셜(네이버)로그인, 스웨거|
|장수현|DESIGN|웹페이지 전체적인 디자인|

<br>


|**팀원**|**블로그**|**깃허브**|
|:-------:|:---:|:---:|
|김지용|[김지용의 블로그](https://haardy.tistory.com/)|[김지용의 깃허브](https://github.com/kkkimjiyong)|
|김수진|[김수진의 블로그](https://resolute-wineberry-8e7.notion.site/99-d5e1109ce701429f9cc2c932a4b92285)|[김수진의 깃허브](https://github.com/kasucco)|
|정원지|[정원지의 블로그](https://1zung.tistory.com/)|[정원지의 깃허브](https://github.com/jee09)|
|조민수|[조민수의 블로그](https://iceflower.tistory.com/)|[조민수의 깃허브](https://github.com/talli0505)|
|서수형|[서수형의 블로그](https://velog.io/@seosu2000)|[서수형의 깃허브](https://github.com/SoohyungSeo)|
|백이현|[백이현의 블로그](https://mement-m0ri.tistory.com/)|[백이현의 깃허브](https://github.com/JadeBeck)|

<br>

# 🕹 프로젝트 소개

평범한 일상 속에서 보드게임을 한다고 가정 해볼까요?

친구, 지인, 혹은 매번 하던 사람들과 게임을 하게 되겠죠.

그러면 그들이 어떤 방식으로 게임을 할지, 이 판이 어떻게 진행될지 눈에 쉽게 보입니다.

그러므로 **즐거움의 한계**를 맞이할 수 있죠. 또한 보드게임 진행에 **가장 어려운 부분은 아무래도 함께 할 사람을 모으는 것**인데요.

그렇다면 오직 보드게임을 좋아한다는 공통점 아래 자율적으로 모인, 생판 모르는 사람들과 보다 더 신나게 게임을 즐겨볼까요?

**재미의 상한선**을 깨 보는거죠! 이러한 기대를 안고 보드게임 파티원 매칭을 도와줄 프로젝트를 지금, 시작합니다!

<br>

# 🕹 페이지 소개

|`로그인 페이지`|`메인 페이지`|`상세 페이지`|`신청 페이지`|
|:-----:|:-----:|:-----:|:-----:|
|<img src="https://user-images.githubusercontent.com/87609692/205592411-ab58f347-5361-4a52-978a-3733f3aba89d.png" width="250"/>|<img src="https://user-images.githubusercontent.com/87609692/205592447-d2e7e148-1b39-4d3c-9468-340d83c99d71.png" width="250"/>|<img src="https://user-images.githubusercontent.com/87609692/205592589-2a4d4717-ddec-48c1-9dad-112b5070109f.png" width="250"/>|<img src="https://user-images.githubusercontent.com/87609692/205592650-b20a727c-7311-45ac-80ec-775c44ad128f.png" width="250"/>|

|`채팅 페이지`|`아바타 페이지`|`랭킹 페이지`|`마이 페이지`|
|:-----:|:-----:|:-----:|:-----:|
|<img src="https://user-images.githubusercontent.com/87609692/205592735-fb4ffa00-9447-4852-b919-86125710d458.png" width="250"/>|<img src="https://user-images.githubusercontent.com/87609692/205592816-4b1685cf-19ad-4d87-aa4e-44f05361c965.png" width="250"/>|<img src="https://user-images.githubusercontent.com/87609692/205592821-075c8b3f-9492-4dd3-b1bc-fd0c33efc632.png" width="250"/>|<img src="https://user-images.githubusercontent.com/87609692/205592824-6d36022f-d8ad-436d-ac51-f1b755708ea5.png" width="250"/>|

<br>

# 🕹 기능 소개

**회원가입**
- 기본 회원 가입과 소셜을 통한 회원가입

**메인 페이지**
- 보드 게임 파티원을 모집할 수 있는 게시글 작성 및 확인 

**필터링, 검색, 북마크**
- 유저가 위치, 시간, 인원을 통해 원하는 게시글 필터링
- 인상 깊었거나 생각나는 제목 혹은 유저 닉네임을 검색
- 마음이 가거나 하고 싶은 게임을 찜해둘수 있는 북마크

**위치기반**
- 자기가 있는 위치에서 가장 가까운 장소가 적힌 게시글 정렬 

**커스텀 아바타**
- 게시글을 달아서 얻은 포인트로 원하는 아바타로 커스텀

**랭킹시스템**
- 지금까지 얻은 포인트를 가지고 순위 측정

<br>

# 🕹 깃허브

### 💻 Front-End

[GitHub](https://github.com/kkkimjiyong/BBoDeeok)

### 💻 Back-End

[GitHub](https://github.com/talli0505/Hanghae_final_mongoose)

# 🕹 서비스 아키택쳐

<img width="80%" src="https://user-images.githubusercontent.com/87609692/207633610-08c75275-3bad-4135-bcff-8079e2d304cb.png" >

<br>

# 🕹 Front-End Tool
<img alt="React" src ="https://img.shields.io/badge/React-61DAFB.svg?&style=for-the-badge&logo=React&logoColor=black"/> <img alt="Redux" src ="https://img.shields.io/badge/Redux-764ABC.svg?&style=for-the-badge&logo=Redux&logoColor=black"/> <img alt="Axios" src ="https://img.shields.io/badge/Axios-5A29E4.svg?&style=for-the-badge&logo=Axios&logoColor=black"/> <img alt="styled Components" src ="https://img.shields.io/badge/styled Components-DB7093.svg?&style=for-the-badge&logo=styled Components&logoColor=black"/> <img alt="Vercel" src ="https://img.shields.io/badge/Vercel-000000.svg?&style=for-the-badge&logo=Vercel&logoColor=white"/> 

<br>

# 🕹 Back-End Tool

<img alt="JavaScript" src ="https://img.shields.io/badge/JavaScriipt-F7DF1E.svg?&style=for-the-badge&logo=JavaScript&logoColor=black"/> <img alt="Pm2" src ="https://img.shields.io/badge/pm2-2B037A.svg?&style=for-the-badge&logo=pm2&logoColor=white"/> <img alt="Nginx" src ="https://img.shields.io/badge/nginx-009639.svg?&style=for-the-badge&logo=nginx&logoColor=white"/> <img alt="JSON Web Tokens" src ="https://img.shields.io/badge/JSON Web Tokens-000000.svg?&style=for-the-badge&logo=JSON Web Tokens&logoColor=white"/> <img alt="MongoDB" src ="https://img.shields.io/badge/MongoDB-47A248.svg?&style=for-the-badge&logo=MongoDB&logoColor=white"/> <img alt="Node.js" src ="https://img.shields.io/badge/Node.js-339933.svg?&style=for-the-badge&logo=Node.js&logoColor=white"/>
<br>
<img alt="Socket.io" src ="https://img.shields.io/badge/Socket.io-010101.svg?&style=for-the-badge&logo=Socket.io&logoColor=white"/> <img alt="GitHub" src ="https://img.shields.io/badge/GitHub-181717.svg?&style=for-the-badge&logo=GitHub&logoColor=white"/> <img alt="Amazon EC2" src ="https://img.shields.io/badge/Amazon EC2-FF9900.svg?&style=for-the-badge&logo=Amazon EC2&logoColor=white"/> <img alt="social login KakaoTalk" src ="https://img.shields.io/badge/social login KakaoTalk-FFCD00.svg?&style=for-the-badge&logo=KakaoTalk&logoColor=black"/> <img alt="Express" src ="https://img.shields.io/badge/Express-000000.svg?&style=for-the-badge&logo=Express&logoColor=white"/>

<br>

## 🕹 ERD
<details>
  <summary>ERD 사진</summary>
  <img src="https://user-images.githubusercontent.com/87609692/205525590-c0404b20-0476-44af-a413-626bee28ac20.png"></img>
</details>

<br>

## 🕹 Swagger
<details>
  <summary>Swagger 사진</summary>
  <img src="https://user-images.githubusercontent.com/87609692/205597720-e52a5fcb-51f1-4235-be2f-f27884619695.png"></img>
</details>

<br>

## 🕹 트러블 슈팅
<h3>BE</h3>
<details>
  <summary>MySQL -> MongoDB</summary>
  <br>
  <p><strong>도입</strong> : 기존에 사용해왔던 부분이라 MySQL default처럼 사용해도 큰 문제가 없을거 같아 이용했습니다. </p>
  <p><strong>문제상황</strong> : 긴 프로젝트를 진행하면서 스키마를 추가해야하는 상황이 생기고, 그로 인해 테이블도 자주 변경하는 현상이 일어나, 유연하지 않은 관계형 데이터베이스를 사용하는데에 어려움이 생겼습니다. 그리고 매칭시스템을 하기 위해서 실시간 채팅을 도입해야했고, 채팅의 특성상 처리해야 할 데이터의 양이 빠르게 증가하기 때문에 수평 확장을 통해 더 많은 탄력성을 제공하는 noSQL 도입의 필요성을 더 크게 느꼈습니다.</p>
  <p><strong>의견 결정</strong> : 많은 데이터를 저장해야하고, 스키마에 대한 정의가 없어서 그때 그때 변경할수있고, 최적화된 Key-Value기법으로 저장하기에 응답,처리속도가 좋은 MongoDB로 결정했습니다. </p>
</details>
<details>
  <br>
  <summary>Access Token, Refresh Token</summary>
  <p><strong>도입</strong> : access Token만 있을 경우, 계속 사용하기 때문에 시간을 늘려야하는데, 이때, 탈취가되면 그 긴 시간동안 마음대로 사용할 수 있기때문, Refresh Token 도입 </p>
  <p><strong>문제상황</strong> : Refresh Token을 DB에 저장하고 Access Token이 만료가 됐을 때, DB에 Refresh Token이 살아있는 걸 확인한 후 자동적으로 Access Token생성해주다보니, 여전히 Access Token이 만료되더라도 탈취가 되면 자동적으로 생성해서 주기 때문에 Refresh Token을 도입한 이유가 없습니다.</p>
  <p><strong>의견 결정</strong> : 로그인 시 Refresh Token을 프론트한테 넘겨줘서 만료 시에 그 Refresh Token과 DB에 있는게 맞는지 체크 후, Refresh Token 만료인지 아닌지 다 체크한 후에 Access Token을 보내주도록 설정했습니다. </p>
</details>
<details>
  <br>
  <summary>Socket.io 연결</summary>
  <p><strong>도입</strong> : 채팅방 기능을 위해서 websocket을 위한 구현보다 모든 브라우저에 적용이 되면서 기능 자체가 포함되어있는 socket.io를 선택하게 되었습니다. </p>
  <p><strong>문제상황</strong> : http에서 아무 문제 없던 부분이 nginx를 통해 연결하고나니, websocket connection failed라는 반복적인 오류를 계속해서 등장하였고, 1대1 채팅은 괜찮았지만 여러명이 들어와서 채팅을 경우 순간적으로 백과 프론트 연결이 끊어지면서 더 많은 failed 문자가 나왔습니다.</p>
  <p><strong>의견 결정</strong> : Nginx 안에서도 websocket을 가능하게 열어주는 시스템이 존재하였습니다. Nginx 기본 설정으로는 1.0으로 되어있는데 커넥션을 유지하기 위해서는 version을 1.1로 바꿔줘야하고, 홉 사이간의 연결, 즉 두 서버 사이에만 영향이 있고, 다른 영향을 안주면서 커넥션을 유지하고, 새 커넥션을 안열기 위해 hop-by-hop 헤더를 넣어서 오류가 안뜨게 해줬습니다. </p>
</details> 
<details>
  <br>
  <summary>포인트 해킹</summary>
  <p><strong>도입</strong> : 아바타서비스가 있기때문에 이 서비스를 위해서 포인트 제도를 도입 </p>
  <p><strong>문제상황</strong> : 프론트 측에서 포인트 차감을 계산을 다 하고나서 유저 변경하는 api에 쏴주는 형식으로 설정을 해두었으나, devTool을 통해 api경로만 알면 Thunder, Postman 등으로 포인트를 임의적으로 수정이 가능해지는 상황이 발생해 버렸습니다.</p>
  <p><strong>의견 결정</strong> : 프론트 측에서 보내주지말고, 백에서 자체적으로 아바타 번경 시 값이 자동 차감되도록하고, 유저변경 사항에는 포인트 자체를 변경 못하도록 막았습니다.  </p>
</details> 
<h3>FE</h3>
<details>
  <br>
  <summary>useState의 비동기적 작동으로 인한 이슈</summary>
  <p><strong>도입</strong> : 위치기반서비스를 위해서, 모임의 좌표와 유저의 현재위치 좌표값 사이의 거리를 다시 배열에 넣어주어야함. </p>
  <p><strong>문제상황</strong> : map함수를 돌린 뒤, 각각의 리턴값에서 거리를 다시 배열에 넣어주어야 하는데, 가장 마지막으로 계산된 거리만 배열에 들어가는 상황이 발생함.</p>
  <p><strong>의견 결정</strong> :  useState는 비동기적으로 작동하며, batch형태로 16ms마다 일괄처리하는 방식임을 알게되었다. 그리고 useState를 동기적으로 처리하기위해서 setState의 인자로 콜백함수를 넣어, 동기적으로 처리하여 정상으로 배열에 넣어줄 수 있게되었다.  </p>
</details> 
